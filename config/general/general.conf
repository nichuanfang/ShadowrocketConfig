[General]
# --- 基础连接设置 ---
# 旁路系统，防止推送延迟 (建议开启)
bypass-system = true

# 跳过代理，解决国内 App 和局域网兼容性
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, captive.apple.com, *.ccb.com, *.abchina.com.cn, *.psbc.com, www.baidu.com, www.163.com, *.chuanfang.org, *.jd.com, *.taobao.com, *.tmall.com

# TUN 旁路路由，优化 TCP 以外的流量
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32

# --- DNS 优化策略 (核心修改) ---
# 推荐使用：阿里/腾讯公共 DNS + 加密 DNS (DoH)
# 这样既能保证国内访问快，又能防止国外域名被污染
dns-server = system, 223.5.5.5, 119.29.29.29

# 备用 DNS，当主 DNS 失败时回退
# fallback-dns-server = system, 8.8.8.8, 1.1.1.1

# 直连域名强制使用系统 DNS (提高国内加载速度)
dns-direct-system = true

# 私有 IP 应答 (防止因劫持导致的强制代理)
private-ip-answer = true

# DNS 劫持，拦截硬编码 DNS 的请求
hijack-dns = 8.8.8.8:53, 8.8.4.4:53, 208.67.222.222:53

# --- 协议与 IP 设置 ---
# 启用 IPv6 但不首选 (目前最优解，防止部分网络环境下 App 载入慢)
ipv6 = true
prefer-ipv6 = false

# 屏蔽代理流量的 QUIC (重点：解决 YouTube/Instagram 视频断流和加载慢)
block-quic = all-proxy

# UDP 不支持时的回退行为 (建议 DIRECT，保证语音通话不中断)
udp-policy-not-supported-behaviour = DIRECT

# ICMP 自动回复 (优化延迟测试显示)
icmp-auto-reply = true

# --- 进阶优化 ---
# 允许 DNS SVCB 查询 (防止一些现代协议解析异常)
allow-dns-svcb = true

# 始终真实 IP (在解析特定域名时很有用)
# always-real-ip = *.srv.nintendo.net, *.stun.playstation.net
